<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
    <title>Javascript PDP 11/45 Emulator v1.8</title>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8">
    <meta name="description" content="Javascript PDP 11/70 Emulator v1.8">
    <meta name="keywords" content="TypeScript,PDP,11,11/70,11/45,Console Panel,RSTS/E Idle Loop,Emulator,Emulation,JavaScript">
    <meta name="author" content="Paul Nankervis">
    <link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32" />
    <!--Send feedback, fixes and suggestions to Paul Nankervis at paulnank@hotmail.com-->
    <!--I'm particularly interested in hearing from anyone with real experience on a PDP 11/70 front panel-->
    <style type="text/css">
        .panel {
            height: 304;
            width: 720;
            position: relative;
            color: white;
            font-family: palatino, verdana;
            font-size: 5px;
            vertical-align: middle;
            background-color: #202020;
        }

        .base {
            top: 0;
            left: 0;
            height: 10px;
            width: 66px;
            font-size: 6px;
            background-color: #EA2020;
            text-align: right;
            position: absolute;
            float: left;
        }

        .ledpad {
            top: 10;
            height: 34px;
            width: 21px;
            background-color: black;
            border-bottom-left-radius: 6px;
            border-bottom-right-radius: 6px;
            align: centre;
            text-align: center;
            vertical-align: middle;
            position: absolute;
            float: left;
        }

        .led {
            top: 14;
            left: 6;
            height: 9px;
            width: 9px;
            border-radius: 3px;
            background-color: red;
            position: absolute;
            float: left;
        }

        .switch_background_top {
            height: 90px;
            width: 154px;
            border-radius: 5px;
            position: absolute;
            background-color: #000000;
            line-height: 7px;
            float: left;
        }

        .switch_background_bottom {
            height: 44px;
            width: 154px;
            border-radius: 5px;
            position: absolute;
            background-color: #000000;
            line-height: 7px;
            float: left;
        }

        .switch_pad {
            height: 28px;
            width: 21px;
            border-radius: 6px;
            position: absolute;
            background-color: #D01010;
            line-height: 28px;
            float: left;
        }

        .switchRed {
            top: 0;
            height: 2;
            width: 9;
            background: #E03030;
            position: absolute;
            border-top: 22px solid #D02020;
            border-bottom: 22px solid #701010;
            border-left: 6px solid #303030;
            border-right: 6px solid #202020;
            transition: .4s;
        }

        .switchPurple {
            top: 0;
            height: 2;
            width: 9;
            background: #A010A0;
            position: absolute;
            border-top: 22px solid #801080;
            border-bottom: 22px solid #500050;
            border-left: 6px solid #303030;
            border-right: 6px solid #202020;
            transition: .4s;
        }

        .leddiv {
            height: 9px;
            width: 9px;
            border-radius: 3px;
            background-color: red;
            visibility: hidden;
            float: left;
        }

        .rotary-switch {
            position: absolute;
            border: solid 1px #202020;
            border-radius: 50%;
            background: linear-gradient(0deg, #b0b0c0, #020212 25%, #404050 35%, #303040 65%, #020212 75%, #b0b0c0);
            transform: rotate(-45deg);
            transition: .4s;
        }

        .rotary-switch:before {
            position: absolute;
            display: block;
            content: "";
            width: 50%;
            height: 6%;
            top: 47%;
            background: #FAF8F9;
            margin: 0% auto;
        }

        .rotary-centre {
            position: absolute;
            background: #FAF8F9;
            left: 44%;
            top: 44%;
            width: 12%;
            height: 12%;
            border-radius: 50%;
        }

        .lock {
            position: absolute;
            border: solid 2px #11100e;
            border-radius: 50%;
            background: linear-gradient(0deg, #8d8280, #d0d0d0);
            transform: rotate(315deg);
        }

        .lock:before {
            position: absolute;
            display: block;
            content: "";
            width: 70%;
            height: 10%;
            top: 45%;
            left: 16%;
            background: #0a0a0a;
            margin: 0% auto;
        }

        .lock-notch {
            position: absolute;
            display: block;
            content: "";
            width: 12%;
            height: 25%;
            top: 15%;
            left: 44%;
            background: #0a0a0a;
            margin: 0% auto;
        }

        .lock-centre {
            position: absolute;
            background: linear-gradient(0deg, #c0c0c0, #202224);
            left: 23%;
            top: 23%;
            width: 44%;
            height: 44%;
            border-radius: 50%;
            border: solid 1px #0a0a0a;
        }

        .lock-centre:before {
            position: absolute;
            display: block;
            content: "";
            width: 22%;
            height: 25%;
            top: 38%;
            left: 83%;
            background: #0a0a0a;
            margin: 0% auto;
        }
    </style>
</head>

<body>
    <div class="panel">
		
        <div style="position:absolute;top:40;left:32;">
            <div style="position:absolute;left:0;">
                <div class="base" style="border-top-left-radius:4px;"></div>
                <div class="ledpad" style="left:0;">
                    <div id=a17 class=led></div>
                </div>
                <div class="ledpad" style="left:22;">
                    <div id=a16 class=led></div>
                </div>
                <div class="ledpad" style="left:44;">
                    <div id=a15 class=led></div>
                </div>
            </div>
            <div style="position:absolute;left:66;">
                <div class="base" style="background-color:#701070;"></div>
                <div class="ledpad" style="left:0;">
                    <div id=a14 class=led></div>
                </div>
                <div class="ledpad" style="left:22;">
                    <div id=a13 class=led></div>
                </div>
                <div class="ledpad" style="left:44;">
                    <div id=a12 class=led></div>
                </div>
            </div>
            <div style="position:absolute;left:132;">
                <div class="base"></div>
                <div class="ledpad" style="left:0;">
                    <div id=a11 class=led></div>
                </div>
                <div class="ledpad" style="left:22;">
                    <div id=a10 class=led></div>
                </div>
                <div class="ledpad" style="left:44;">
                    <div id=a9 class=led></div>
                </div>
            </div>
            <div style="position:absolute;left:196;">
                <div class="base" style="background-color:#701070;"></div>
                <div class="ledpad" style="left:0;">
                    <div id=a8 class=led></div>
                </div>
                <div class="ledpad" style="left:22;">
                    <div id=a7 class=led></div>
                </div>
                <div class="ledpad" style="left:44;">
                    <div id=a6 class=led></div>
                </div>
            </div>
            <div style="position:absolute;left:262;">
                <div class="base"></div>
                <div class="ledpad" style="left:0;">
                    <div id=a5 class=led></div>
                </div>
                <div class="ledpad" style="left:22;">
                    <div id=a4 class=led></div>
                </div>
                <div class="ledpad" style="left:44;">
                    <div id=a3 class=led></div>
                </div>
            </div>
            <div style="position:absolute;left:328;">
                <div class="base" style="background-color:#701070;border-top-right-radius:4px;">ADDRESS &nbsp;</div>
                <div class="ledpad" style="left:0;">
                    <div id=a2 class=led></div>
                </div>
                <div class="ledpad" style="left:22;">
                    <div id=a1 class=led></div>
                </div>
                <div class="ledpad" style="left:44;">
                    <div id=a0 class=led></div>
                </div>
            </div>
        </div>


        <div style="position:absolute;top:40;left:450;">
            <div class="switch_background_top" style="width:240;height:46;border-radius:8;">
                <div style="display:table;text-align:left;font-size:5px;border-spacing:4px;">
                    <div style="display:table-row;height:18px">
                        <div class=leddiv id=s11 style="display:table-cell;"></div>
                        <div style="display:table-cell;width:32">USER I</div>
                        <div class=leddiv id=s9 style="display:table-cell;"></div>
                        <div style="display:table-cell;width:32">SUPER I</div>
                        <div class=leddiv id=s7 style="display:table-cell;"></div>
                        <div style="display:table-cell;width:32">KERNEL I</div>
                        <div class=leddiv id=s5 style="display:table-cell;"></div>
                        <div style="display:table-cell;width:32">PROG PHY</div>
                    </div>
                    <div style="display:table-row;height:21px">
                        <div class=leddiv id=s10 style="display:table-cell;"></div>
                        <div style="display:table-cell;">USER D</div>
                        <div class=leddiv id=s8 style="display:table-cell;"></div>
                        <div style="display:table-cell">SUPER D</div>
                        <div class=leddiv id=s6 style="display:table-cell;"></div>
                        <div style="display:table-cell">KERNEL D</div>
                        <div class=leddiv id=s4 style="display:table-cell;"></div>
                        <div style="display:table-cell">CONS PHY</div>
                    </div>
                </div>

                <div id=rotary2 class="rotary-switch" style="position:absolute;top:7;right:7;height:30px;width:30px" onclick="if (++panel.rotary2>7) panel.rotary2=0;rotary2.style.transform='rotate('+(panel.rotary2*45-45)+'deg)';panel.select=updatePanel('s',panel.select,(panel.select&0x300f)|(0x10<<panel.rotary2)); panel.address = updatePanel('a', panel.address, (panel.rotary2 == 1 ? CPU.displayPhysical : (panel.rotary2 == 0 ? CPU.displayAddress : CPU.displayAddress & 0xffff))); panel.autoIncr = 0;">
                    <div class="rotary-centre"> </div>
                </div>
            </div>
        </div>


        <div style="position:absolute;top:114;left:450;">
            <div class="switch_background_bottom" style="width:240;height:46;border-radius:8;">
                <div style="display:table;text-align:left;font-size:5px;border-spacing:4px;">
                    <div style="display:table-row;height:18px">
                        <div class=leddiv id=s0 style="display:table-cell;"></div>
                        <div style="display:table-cell;width:64">DATA PATHS</div>
                        <div class=leddiv id=s1 style="display:table-cell;"></div>
                        <div style="display:table-cell;width:46">U ADRS &nbsp; FPP/CPU &nbsp;</div>
                    </div>
                    <div style="display:table-row;height:21px">
                        <div class=leddiv id=s2 style="display:table-cell;"></div>
                        <div style="display:table-cell">BUS REGISTER</div>
                        <div class=leddiv id=s3 style="display:table-cell;"></div>
                        <div style="display:table-cell">DISPLAY REGISTER</div>
                    </div>
                </div>
                <div id=rotary1 class="rotary-switch" style="position:absolute;top:7;right:7;height:30px;width:30px" onclick="if (++panel.rotary1>3) panel.rotary1=0;rotary1.style.transform='rotate('+(panel.rotary1*45-45)+'deg)';panel.select=updatePanel('s',panel.select,(panel.select&0x3ff0)|(0x1<<panel.rotary1)); if (panel.rotary1) panel.display = updatePanel('d', panel.display, (panel.rotary1 == 2 ? CPU.switchRegister :CPU.displayRegister));">
                    <div class="rotary-centre"> </div>
                </div>
            </div>
        </div>

        <div style="position:absolute;top:114;left:32;">
            <div style="position:absolute;top:0;left:0;font-size:5px">POWER</DIV>
            <div style="position:absolute;top:0;left:26;font-size:5px">LOCK</DIV>
			<div class="lock" style="position:absolute;top:8;left:6;height:18px;width:18px">
				<div class="lock-notch"> </div>
				<div class="lock-centre"> </div>
			</div>
            <div style="position:absolute;top:33;left:1;font-size:5px">OFF</DIV>
            <div style="position:absolute;left:44;">
                <div class="base" style="width:28;border-top-left-radius:4px;"></div>
                <div class="ledpad" style="left:0;">
                    <div id=d15 class=led></div>
                </div>
            </div>
            <div style="position:absolute;left:66;">
                <div class="base" style="background-color:#701070;"></div>
                <div class="ledpad" style="left:0;">
                    <div id=d14 class=led></div>
                </div>
                <div class="ledpad" style="left:22;">
                    <div id=d13 class=led></div>
                </div>
                <div class="ledpad" style="left:44;">
                    <div id=d12 class=led></div>
                </div>
            </div>
            <div style="position:absolute;left:132;">
                <div class="base"></div>
                <div class="ledpad" style="left:0;">
                    <div id=d11 class=led></div>
                </div>
                <div class="ledpad" style="left:22;">
                    <div id=d10 class=led></div>
                </div>
                <div class="ledpad" style="left:44;">
                    <div id=d9 class=led></div>
                </div>
            </div>
            <div style="position:absolute;left:196;">
                <div class="base" style="background-color:#701070;"></div>
                <div class="ledpad" style="left:0;">
                    <div id=d8 class=led></div>
                </div>
                <div class="ledpad" style="left:22;">
                    <div id=d7 class=led></div>
                </div>
                <div class="ledpad" style="left:44;">
                    <div id=d6 class=led></div>
                </div>
                <div class="bytediv">&nbsp;</div>
            </div>
            <div style="position:absolute;left:262;">
                <div class="base"></div>
                <div class="ledpad" style="left:0;">
                    <div id=d5 class=led></div>
                </div>
                <div class="ledpad" style="left:22;">
                    <div id=d4 class=led></div>
                </div>
                <div class="ledpad" style="left:44;">
                    <div id=d3 class=led></div>
                </div>
            </div>
            <div style="position:absolute;left:328;">
                <div class="base" style="background-color:#701070;border-top-right-radius:4px;">DATA</div>
                <div class="ledpad" style="left:0;">
                    <div id=d2 class=led></div>
                </div>
                <div class="ledpad" style="left:22;">
                    <div id=d1 class=led></div>
                </div>
                <div class="ledpad" style="left:44;">
                    <div id=d0 class=led></div>
                </div>
            </div>


            <div style="position:absolute;top:54;left:0;">
                <img src="pdp11-45.svg" alt="pdp11-45" width="126">
            </div>

            <div style="position:absolute;top:56;left:392;">
                <div class="ledpad" style="left:27;width:27;">ADRS ERR
                    <div id=m10 class=led style="left:9;"></div>
                </div>
                <div class="ledpad" style="left:57;width:27;">RUN
                    <div id=m9 class=led style="left:9;"></div>
                </div>
                <div class="ledpad" style="left:87;width:27;">PAUSE
                    <div id=m8 class=led style="left:9;"></div>
                </div>
                <div class="ledpad" style="left:117;width:27;">MASTER
                    <div id=m7 class=led style="left:9;"></div>
                </div>
                <div class="ledpad" style="left:147;width:27;">USER
                    <div id=m6 class=led style="left:9;"></div>
                </div>
                <div class="ledpad" style="left:177;width:27;">SUPER
                    <div id=m5 class=led style="left:9;"></div>
                </div>
                <div class="ledpad" style="left:207;width:27;">KERNEL
                    <div id=m4 class=led style="left:9;"></div>
                </div>
                <div class="ledpad" style="left:237;width:27;">DATA
                    <div id=m3 class=led style="left:9;"></div>
                </div>
            </div>


        </div>

        <div align="center" style="position:absolute;top:220;left:32;">
            <div style="position:absolute;left:0;">
                <div class="switch_pad" style="left:0;">17</div>
                <div class="switch_pad" style="left:22;">16</div>
                <div class="switch_pad" style="left:44;">15</div>
            </div>
            <div style="position:absolute;left:66;">
                <div class="switch_pad" style="left:0;background-color:#701070;">14</div>
                <div class="switch_pad" style="left:22;background-color:#701070;">13</div>
                <div class="switch_pad" style="left:44;background-color:#701070;">12</div>
            </div>
            <div style="position:absolute;left:132;">
                <div class="switch_pad" style="left:0;">11</div>
                <div class="switch_pad" style="left:22;">10</div>
                <div class="switch_pad" style="left:44;">9</div>
            </div>
            <div style="position:absolute;left:198;">
                <div class="switch_pad" style="left:0;background-color:#701070;">8</div>
                <div class="switch_pad" style="left:22;background-color:#701070;">7</div>
                <div class="switch_pad" style="left:44;background-color:#701070;">6</div>
            </div>
            <div style="position:absolute;left:264;">
                <div class="switch_pad" style="left:0;">5</div>
                <div class="switch_pad" style="left:22;">4</div>
                <div class="switch_pad" style="left:44;">3</div>
            </div>
            <div style="position:absolute;left:330;">
                <div class="switch_pad" style="left:0;background-color:#701070;">2</div>
                <div class="switch_pad" style="left:22;background-color:#701070;">1</div>
                <div class="switch_pad" style="left:44;background-color:#701070;">0</div>
            </div>
            <div style="position:absolute;left:396;">
                <div class="switch_pad" style="left:22;line-height:9px;"><br>LOAD<br>ADRS</div>
                <div class="switch_pad" style="left:44;background-color:#701070;">EXAM</div>
                <div class="switch_pad" style="left:66;">CONT</div>
                <div class="switch_pad" style="left:88;line-height:9px;background-color:#701070;"><br>ENABLE<br>HALT</div>
                <div class="switch_pad" style="left:110;line-height:9px;"><br>S INST<br>S BUS</div>
                <div class="switch_pad" style="left:132;background-color:#701070;">START</div>
                <div class="switch_pad" style="left:176;">DEP</div>
                <div class="switch_pad" style="left:220;background-color:#701070;line-height:9px;"><br>REG<br>EXAM</div>
                <div class="switch_pad" style="left:242;line-height:9px;"><br>REG<br>DEP</div>
            </div>
        </div>

        <div style="position:absolute;top:252;left:32;width:720;">
            <div style="position:absolute;left:0;">
                <div id=sw17 class="switchRed" style="left:0;" onclick="setSwitch('sw17',131072);"></div>
                <div id=sw16 class="switchRed" style="left:22;" onclick="setSwitch('sw16',65536);"></div>
                <div id=sw15 class="switchRed" style="left:44;" onclick="setSwitch('sw15',32768);"></div>
            </div>
            <div style="position:absolute;left:66;">
                <div id=sw14 class="switchPurple" style="left:0;" onclick="setSwitch('sw14',16384);"></div>
                <div id=sw13 class="switchPurple" style="left:22;" onclick="setSwitch('sw13',8192);"></div>
                <div id=sw12 class="switchPurple" style="left:44;" onclick="setSwitch('sw12',4096);"></div>
            </div>
            <div style="position:absolute;left:132;">
                <div id=sw11 class="switchRed" style="left:0;" onclick="setSwitch('sw11',2048);"></div>
                <div id=sw10 class="switchRed" style="left:22;" onclick="setSwitch('sw10',1024);"></div>
                <div id=sw9 class="switchRed" style="left:44;" onclick="setSwitch('sw9',512);"></div>
            </div>
            <div style="position:absolute;left:198;">
                <div id=sw8 class="switchPurple" style="left:0;" onclick="setSwitch('sw8',256);"></div>
                <div id=sw7 class="switchPurple" style="left:22;" onclick="setSwitch('sw7',128);"></div>
                <div id=sw6 class="switchPurple" style="left:44;" onclick="setSwitch('sw6',64);"></div>
            </div>
            <div style="position:absolute;left:264;">
                <div id=sw5 class="switchRed" style="left:0;" onclick="setSwitch('sw5',32);"></div>
                <div id=sw4 class="switchRed" style="left:22;" onclick="setSwitch('sw4',16);"></div>
                <div id=sw3 class="switchRed" style="left:44;" onclick="setSwitch('sw3',8);"></div>
            </div>
            <div style="position:absolute;left:330;">
                <div id=sw2 class="switchPurple" style="left:0;" onclick="setSwitch('sw2',4);"></div>
                <div id=sw1 class="switchPurple" style="left:22;" onclick="setSwitch('sw1',2);"></div>
                <div id=sw0 class="switchPurple" style="left:44;;" onclick="setSwitch('sw0',1);"></div>
            </div>
            <div style="position:absolute;left:396;">
                <div id=lt class="switchRed" style="left:0;background-color: #D0D0D0;border-top-color:#C0C0C0;border-bottom-color:#606060;" onclick="panel.lamp--; moveSwitch('lt', (panel.lamp ? 36 : 22));  updatePanel('a',panel.lamp?0:0x3fffff,panel.lamp?0x3fffff:panel.address); updatePanel('d',panel.lamp?0:0xffff,panel.lamp?0xffff:panel.display); updatePanel('m',panel.lamp?0:0xfff,panel.lamp?0xfff:panel.status); updatePanel('s',panel.lamp?0:0x3fff,panel.lamp?0x3fff:panel.select); if (panel.lamp) panel.lamp = 1;"></div>
                <div id=load class="switchRed" style="left:22;" onclick="moveSwitch('load', 36); CPU.displayAddress = CPU.switchRegister; if (panel.rotary2 > 1) CPU.displayAddress &= 0xffff; panel.address = updatePanel('a', panel.address, CPU.displayAddress); panel.autoIncr = 0; setTimeout(function() {moveSwitch('load', 22);},300);"></div>
                <div id=examine class="switchPurple" style="left:44;" onclick="moveSwitch('examine', 36); if (CPU.runState == STATE.HALT) examineDeposit(-1); setTimeout(function() {moveSwitch('examine', 22);},300);"></div>
                <div id=continue class="switchPurple" style="left:66;" onclick="moveSwitch('continue', 36); if (CPU.runState == STATE.HALT) if (panel.halt) { step(0); CPU.runState = STATE.HALT; }  else {CPU.runState = STATE.RUN; setTimeout(emulate, 1);}; setTimeout(function() {moveSwitch('continue', 22);},300);"></div>
                <div id=halt class="switchPurple" style="left:88;" onclick="panel.halt = 1 - panel.halt; moveSwitch('halt', (panel.halt ? 36 : 22)); if (panel.halt && CPU.runState != STATE.HALT) { CPU.runState = STATE.HALT; updateDisplayLights(0); updateStatusLights(0); }"></div>
                <div id=step class="switchRed" style="left:110;" onclick="panel.step = 1 - panel.step; moveSwitch('step', (panel.step ? 36 : 22));"></div>
                <div id=start class="switchRed" style="left:132;" onclick="moveSwitch('start', 36); if (CPU.runState == STATE.HALT) {reset_iopage(); if (CPU.displayAddress < IOBASE_UNIBUS && ((CPU.displayAddress & 1) || CPU.displayAddress >= MAX_MEMORY)) updateStatusLights(0x400); else { CPU.registerVal[7] = CPU.displayAddress & 0xffff; updateStatusLights(0); if (!panel.halt) {CPU.runState = STATE.RUN; setTimeout(emulate, 1);}}}; setTimeout(function() {moveSwitch('start', 22);},300);"></div>
                <div class="switchRed" style="left:154;background-color: #D0D0D0;border-top-color:#C0C0C0;border-bottom-color:#606060;"></div>
                <div id=deposit class="switchRed" style="left:176;" onclick="moveSwitch('deposit', 8); if (CPU.runState == STATE.HALT) examineDeposit(CPU.switchRegister); setTimeout(function() {moveSwitch('deposit', 22);},300);"></div>
                <div class="switchRed" style="left:198;background-color: #D0D0D0;border-top-color:#C0C0C0;border-bottom-color:#606060;"></div>
                <div id=regExam class="switchPurple" style="left:220;" onclick="moveSwitch('regExam', 36); if (CPU.runState == STATE.HALT) regExamineDeposit(-1); setTimeout(function() {moveSwitch('regExam', 22);},300);"></div>
                <div id=regDeposit class="switchRed" style="left:242;" onclick="moveSwitch('regDeposit', 8); if (CPU.runState == STATE.HALT) regExamineDeposit(CPU.switchRegister); setTimeout(function() {moveSwitch('regDeposit', 22);},300);"></div>
            </div>
        </div>
    </div>

    <form name=console action="foo.bar">
        <textarea name=line cols=80 rows=24 style="font-family:Liberation Mono,Monaco,Courier New,Lucida Console,Consolas,DejaVu Sans Mono,Bitstream Vera Sans Mono,monospace"></textarea>
    </form>
    <button onclick="console_input(3)">Ctrl/C</button>
    <button onclick="console_input(4)">Ctrl/D</button>
    <button onclick="console_input(8)">Ctrl/H</button>
    <button onclick="console_input(10)">LF</button>
    <button onclick="console_input(17)">Ctrl/Q</button>
    <button onclick="console_input(19)">Ctrl/S</button>
    <button onclick="console_input(20)">Ctrl/T</button>
    <button onclick="console_input(26)">Ctrl/Z</button>
    <button onclick="console_input(27)">ESC</button>
    <button onclick="console_input(9)">TAB</button>
    <button onclick="console_input(0)">Break</button>
    <input type=checkbox onclick="tty.delCode = (tty.delCode == 127 ? 8 : 127)">DEL to Ctrl/H
    <button onclick="putchar(10);boot();">REBOOT</button>
	<br />
	<div id="vt11"> </div>
	<br />



<h3>PDP 11/45 Emulator v1.8 &nbsp; October 2017</h3>
<p>
This is that PDP 11/45 emulator which is put together from my earlier <a href="http://skn.noip.me/pdp11/pdp11.html">PDP 11/70</a> emulator. Because a PDP 11/45 has less memory it cannot run some of the software a PDP 11/70 can.</p>
<p>
The PDP 11/45 was released in 1972 and is an older less powerful version of the PDP 11/70 which was released in 1975. It is the second implementation of the PDP 11 following on from the PDP 11/20, which had an odd coupling of a 16 address bit processor to an 18 address bit bus. Naturally then, the PDP 11/45 had to include some form of memory management!</p>
<p>
The PDP 11/45 has the same processor as the PDP 11/70 but lacks 22 bit addressing, restricting it to 124KW of memory instead of 4MB. It also lacks unibus mapping and a number of the PDP 11/70's special control registers. But still it has three addressing modes (Kernel, Supervisor, and User) and implements split Instruction and Data addressing. Split I&amp;D cause Instruction memory references based on the the use of the program counter to map seperately from general Data addressing. As a result a program can have 32768 words of instruction memory <b>AND</b> 32768 words of data. Some of the newer operating systems such as BSD require this to fit programs into memory. Sadly a PDP 11/45 can't run BSD because the system maximum memory limit of 124KW is not sufficient to load the entire operating system.</p>
<p>
One wonders if these types of memory restrictions, which ultimately killed the PDP 11, influenced the design of Unix to be more modular. Perhaps leading to things like shell piping of data between small programs.</p>
<p>
Note: The boot code in this emulator is a custom PDP 11 program running with it's own set of light patterns. It is initially loaded at address 140000 and the LIGHTS command operates by mapping a WAIT instruction to different addresses within Supervisor mode. The source for this program can be found in the RT11 operating environment as <b>BOOT.MAC</b> You can use this code to boot one of the guest OSes or use the LIGHTS command and DIAG command to experiment with idle light patterns and load test the CPU.</p>
<p>
If you wish to toggle in a simple light chaser to the front panel then here are some switch commands which can be used:</p>
<pre>
<b>
Address Data    Code        Switch commands</b>
                            HALT, 001000, LOAD ADDRESS
001000  012700  mov #1,r0   012700, DEPOSIT
001002  000001              000001, DEPOSIT
001004  006100  rol r0      006100, DEPOSIT
001006  000005  reset       000005, DEPOSIT
001010  000775  br .-4      000775, DEPOSIT
                            001000, LOAD ADDRESS, ENABLE, START
</pre>
To restart the initial boot code (if it has not been overwritten) use the switch commands:
<pre>
		HALT, 140000, LOAD ADDRESS, START
</pre>
<p>
Of course if you want your own PDP 11/70 front panel you might consider
<a href="https://hackaday.io/project/8069-pidp-11">one of these</a>.</p>
<p>
Happy emulating!</p>
<p>
Paul Nankervis</p>

<h3>List of guest OS's:</h3>
<table style="margin-left:20px" cellpadding=3>
  <tr><td><b>Disk</b></td><td><b>OS</b></td><td><b>Comment</b></td></tr>
  <tr><td><b>RK0</b></td><td>Unix V5      </td><td>Boot using: <b>unix</b>  then login as <b>root</b></td></tr>
  <tr><td><b>RK1</b></td><td>RT11 v4.0 	</td><td>The lightest/fastest OS here</td></tr>
  <tr><td><b>RK2</b></td><td>RSTS V06C-03 </td><td>Boot and login as <b>1,2</b> with password <b>SYSTEM</b> or as <b>11,70</b> using <b>PDP</b></td></tr>
  <tr><td><b>RK3</b></td><td>XXDP 		</td><td>Diagnostic OS and utilities</td></tr>
  <tr><td><b>RK4</b></td><td>RT-11 3B 		</td><td>Distribution for RT-11 Version 3B</td></tr>
  <tr><td><b>RK5</b></td><td>RT-11 V5.4F	</td><td>Distribution for RT-11 Version 5.4F</td></tr>
  <tr><td><b>RL0</b></td><td>BSD 2.9       </td><td>Boot using: <b>rl(0,0)rlunix</b> &nbsp; CTRL/D to get to multiuser</td></tr>
  <tr><td><b>RL1</b></td><td>RSX 11M v3.2  </td><td><b>Fails on a PDP 11/45</b></td></tr>
  <tr><td><b>RL2</b></td><td>RSTS/E v7.0   </td><td>Option: &lt;LF&gt; Suboption: &lt;LF&gt;  ... Login as <b>1,2</b> using <b>SYSTEM</b> or <b>11,70</b> using <b>PDP</b></td></tr>
  <tr><td><b>RL3</b></td><td>XXDP 		</td><td>Larger version of diagnostics - including PDP 11/70 utilities</td></tr>
  <tr><td><b>RP0</b></td><td>ULTRIX-11 V3.1 </td><td>CTRL/D to enter multiuser mode. Login as <b>root</b> with no password</td></tr>
  <tr><td><b>RP1</b></td><td>BSD 2.11		</td><td><b>Fails on a PDP 11/45</b></td></tr>
  <tr><td><b>RP2</b></td><td>RSTS/E v9.6	</td><td>Answer boot questions and login as <b>1,2</b> (password <b>SYSTEM</b>) or <b>11,70</b> (no password)</td></tr>
  <tr><td><b>RP3</b></td><td>RSX 11M v4.6	</td><td>Starts logged in as <b>1,2</b> (password <b>SYSTEM</b>)  - user accounts <b>200,1</b> (no password) or <b>11,70</b> (password <b>PDP</b>)
</table>
<p>
<b>Note:</b> Disks are shown in approximately order size. The <a href="https://en.wikipedia.org/wiki/RK05">RK05</a> disks at the top are small and not too bad to use across a network.
The <a href="http://www.columbia.edu/cu/computinghistory/rp06.html">RP06</a> disks at the bottom can be rather slow.
<p><a href='https://www.youtube.com/watch?v=3Nr1E96tXRU'>Youtube video 1</a>
<p><a href='https://www.youtube.com/watch?v=F-kJo1DTtw4'>Youtube video 2</a>


<h3>Example boot of Unix V5</h3>
<pre>
BOOT&gt; <b>boot rk0</b>
@<b>unix</b>

login: <b>root</b>
# <b>date</b>
Fri Mar 21 12:09:02 EST 1975
# <b>chdir /etc</b>
# <b>pwd</b>
../etc
# <b>ls -al</b>
total 40
drwxr-xr-x  2 bin       240 Mar 21 12:07 .
drwxr-xr-x  9 bin       160 Jan 29 16:14 ..
-rwxr--r--  1 bin       474 Nov 26 18:13 getty
-rwxr-xr-x  1 bin      1446 Nov 26 18:13 glob
-rwxr--r--  1 bin      1972 Nov 26 18:13 init
-rwxr-xr-x  1 bin       814 Nov 26 18:13 lpd
-rwxr--r--  1 bin      4136 Nov 26 18:13 mkfs
-rwxr--r--  1 bin      1800 Nov 26 18:13 mknod
-rwsr-xr-x  1 root     2078 Nov 26 18:13 mount
-rw-r--r--  1 bin        49 Nov 26 18:13 passwd
-rw-r--r--  1 bin        70 Nov 26 18:13 rc
-rw-r--r--  1 bin        56 Nov 26 18:13 ttys
-rwsr-xr-x  1 root     1990 Nov 26 18:13 umount
-rwxr-xr-x  1 bin        32 Nov 26 18:13 update
-rw-r--r--  1 root      144 Mar 21 12:09 utmp
# <b>cat /etc/passwd</b>
root::0:1::/:
daemon::1:1::/bin:
bin::3:1::/bin:
# <b>cal 10 1981</b>
      Oct 1981
 S  M Tu  W Th  F  S
             1  2  3
 4  5  6  7  8  9 10
11 12 13 14 15 16 17
18 19 20 21 22 23 24
25 26 27 28 29 30 31
# <b>ls -al /bin</b>
total 339
drwxr-xr-x  2 bin       944 Nov 26 18:13 .
drwxr-xr-x  9 bin       160 Jan 29 16:14 ..
-rwxr-xr-x  1 bin      1514 Nov 26 18:13 ar
-rwxr-xr-x  1 bin      7308 Nov 26 18:13 as
-rwxr-xr-x  1 bin      6042 Nov 26 18:13 bas
-rwxr-xr-x  1 bin       152 Nov 26 18:13 cat
-rwxr-xr-x  1 bin      5668 Nov 26 18:13 cc
...
</pre>

<h3>Example boot of RT11 v4.0</h3>
<pre>
BOOT&gt; <b>boot rk1</b>
RT-11SJ  V04.00C

.D 56=5015

.TYPE V4USER.TXT
Welcome to RT-11 Version 4. RT-11 V04 provides new hardware support
and some major enhancements over Version 3B
...
.D 56=0

.<b>MAC BOOT</b>
ERRORS DETECTED:  0

.<b>LINK BOOT</b>

.<b>DIR BOOT</b>

BOOT  .MAC    16                 BOOT  .OBJ     4
BOOT  .SAV     4
 3 Files, 24 Blocks
 2851 Free blocks

.<b>DIR</b>

SWAP  .SYS    25  01-Feb-82      RT11BL.SYS    65  01-Feb-82
RT11SJ.SYS    67  01-Feb-82      RT11FB.SYS    80  01-Feb-82
TT    .SYS     2  01-Feb-82      DT    .SYS     3  01-Feb-82
DP    .SYS     3  01-Feb-82      DX    .SYS     3  01-Feb-82
...
</pre>


<h3>Example boot of RSTS V06C-03</h3>
<pre>
BOOT> <b>boot rk2</b>

RSTS V06C-03 Vixen (DK2)

Option: <b>ST</b>

You currently have: JOB MAX = 31, SWAP MAX = 28K.

JOB MAX or SWAP MAX changes? <b>N</b>

Default memory allocation table specifies nonexistent memory.
Table will be reset by RSTS.

  Memory allocation table:

     0K: 00000000 - 00147777 (  26K) : EXEC
    26K: 00150000 - 00247777 (  16K) : RTS (BASIC)
    42K: 00250000 - 00757777 (  82K) : USER
   124K: 00760000 - End              : NXM

  Table suboption? 

You currently have crash dump disabled.

DD-MMM-YY? <b>31-OCT-76</b>
12:00 PM? <b>11:45</b>
INIT    V06C-03 RSTS V06C-03 Vixen

Command File Name? 
DETACHING...


<b>HELLO</b>

RSTS V06C-03 Vixen  Job 2  KB0  31-Oct-76  11:45 AM
#<b>11/70</b>
Password: <b>PDP</b>

Ready

<b>DIR/S</b>
 Name .Ext   Size    Prot  Access     Date       Time   Clu   RTS   Open
SY:[11,70]
ACEY  .BAS      5   &lt; 60> 31-Oct-76 31-Oct-76  07:19 AM   1  RT11    0
TREK  .BAS     16   &lt; 60> 31-Oct-76 31-Oct-76  06:58 AM   1  BASIC   0
TREK  .DOC      9   &lt; 60> 31-Oct-76 31-Oct-76  06:58 AM   1  RT11    0
ANIMAL.BAS      5   &lt; 60> 31-Oct-76 31-Oct-76  06:59 AM   1  BASIC   0
STRTRK.BAS     27   &lt; 60> 31-Mar-81 31-Mar-81  12:00 M    2  RT11    0
STRTR1.BAS      9   &lt; 60> 31-Mar-81 31-Mar-81  12:06 PM   2  BASIC   0
ADVENT.DOC      4   &lt; 60> 13-Mar-77 20-Jul-85  06:50 AM   1  RT11    0
ADVENT.SAV     93   &lt;124> 13-Mar-77 20-Jul-85  06:50 AM   1  RT11    0
ADVENT.VAR     22   &lt; 60> 13-Mar-77 20-Jul-85  06:50 AM   1  RT11    0
ADVTXT.TXT    125   &lt; 60> 13-Mar-77 20-Jul-85  06:50 AM   1  RT11    0
SYSMAC.SML     42   &lt; 60> 13-Mar-77 13-Mar-77  06:42 AM   1  BASIC   0
HELLO .MAC      1   &lt; 60> 13-Mar-77 13-Mar-77  06:43 AM   1  RT11    0
BOOT  .MAC     24   &lt; 60> 13-Mar-77 13-Mar-77  06:43 AM   1  RT11    0

Total of 382 blocks in 13 files in SY:[11,70]

Ready

<b>RUN ADVENT</b>

WELCOME TO ADVENTURE!!  WOULD YOU LIKE INSTRUCTIONS?

<b>NO</b>
YOU ARE STANDING AT THE END OF A ROAD BEFORE A SMALL BRICK BUILDING.
AROUND YOU IS A FOREST.  A SMALL STREAM FLOWS OUT OF THE BUILDING AND 
DOWN A GULLY. 

<b>EAST</b>
YOU ARE INSIDE A BUILDING, A WELL HOUSE FOR A LARGE SPRING. 

THERE ARE SOME KEYS ON THE GROUND HERE. 

THERE IS A SHINY BRASS LAMP NEARBY. 

THERE IS FOOD HERE. 

THERE IS A BOTTLE OF WATER HERE.

<b>TAKE FOOD</b>
OK

<b>TAKE KEYS</b>
OK

<b>LIGHT LAMP</b>
YOUR LAMP IS NOW ON.

<b>QUIT</b>
DO YOU REALLY WANT TO QUIT NOW? 

<b>YES</b>
OK

YOU SCORED  32 OUT OF A POSSIBLE 350, USING    6 TURNS.

YOU ARE OBVIOUSLY A RANK AMATEUR.  BETTER LUCK NEXT TIME. 

TO ACHIEVE THE NEXT HIGHER RATING, YOU NEED  4 MORE POINTS.

Ready

<b>RUN TREK</b>

ORDERS:   STARDATE = 2000 

AS COMMANDER OF THE UNITED STARSHIP ENTERPRISE, YOUR MISSION
IS TO RID THE GALAXY OF THE DEADLY KLINGON MENACE.   TO DO THIS,
YOU MUST DESTROY THE KLINGON INVASION FORCE OF 22 BATTLE
CRUISERS.   YOU HAVE 40 SOLAR YEARS TO COMPLETE YOUR MISSION.
( I.E. UNTIL STARDATE 2040 )

GIVE COMMAND 'END' TO STOP THE GAME EARLY.
DO YOU REQUIRE FURTHER INSTRUCTIONS? N

DO YOU WANT A CHART? <b>Y</b>

     1   2   3   4   5   6   7   8 
   ---------------------------------
 1 :   :   :   :   :   :   :   :   :
   ---------------------------------
 2 :   :   :   :   :   :   :   :   :
   ---------------------------------
 3 :   :   :   :   :   :   :   :   :
   ---------------------------------
 4 :   :   :   :   :   :   :   :   :
   ---------------------------------
 5 :   :   :   :   :   :   :   :   :
   ---------------------------------
 6 :   :   :   :   :   :   :   :   :
   ---------------------------------
 7 :   :   :   :   :   :   :   :   :
   ---------------------------------
 8 :   :   :   :   :   :   :   :   :
   ---------------------------------

YOU ARE CURRENTLY IN QUADRANT 5 - 2 

---------------
B . . . . . . . 
. * . . . . . . 
. . . . . . E . 
. . . . . . . . 
. . * . . . . . 
* . . . . . . . 
. . . . . . . . 
. . . . . * . . 
---------------

STARDATE: 2000           CONDITION: YELLOW
QUADRANT: 5 - 2          SECTOR: 7 - 3 
ENERGY: 3000             PHOTON TORPEDOS: 10 
KLINGONS: 22 

COMMAND? <b>^C</b>

Ready

<b>SYSTAT</b>

RSTS V06C-03 Vixen status at 31-Oct-76, 11:47 AM Up: 2:08

Job    Who    Where    What    Size    State    Run-Time   RTS
 1    [OPR]   Det     ERRCPY    5K     SR            3.7  BASIC 
 2    [SELF]  KB0     SYSTAT    8K     RN Lck        4.6  BASIC 

Busy Devices: None

Disk Structure:
Disk    Open    Free    Cluster Errors  Name    Comments
DK2       3     315        1      0     VIXEN   Pub, DLW

Small   Large   Jobs    Hung TTY's      Errors
385       1      2/2        0              0

Run-Time Systems:
 Name   Ext       Size  Users   Comments
BASIC   BAC     16(16)K   2     Perm, Addr:26, KBM, CSZ
RSX     TSK      2(28)K   0     Non-Res, KBM
RT11    SAV      4(28)K   0     Temp, Addr:49, KBM, CSZ, EMT:255
RMS11   TSK      4(28)K   0     Non-Res

Message Receivers:
 Name   Job     Msgs    Max     Senders
ERRLOG   1       0      40      Priv

Ready

<b>RUN $SWITCH</b>
Run-Time System to switch to? <b>RT11</b>

.<b>MACRO HELLO=HELLO</b>
ERRORS DETECTED:  0

.<b>LINK HELLO=HELLO</b>

.<b>RUN HELLO</b>
HELLO, WORLD!
.<b>BYE</b>
Confirm: <b>Y</b>
Saved all disk files; 384 blocks in use, 116 free
Job 2 User 11,70 logged off KB0 at 31-Oct-76 11:47 AM
System RSTS V06C-03 Vixen
Run time was 5.3 seconds
Elapsed time was 2 minutes
Good morning

</pre>
<h3>Example boot of XXDP</h3>
<pre>
BOOT&gt; <b>boot rk3</b>

CHMDKB1 XXDP+ DK MONITOR
BOOTED VIA UNIT 2
28K UNIBUS SYSTEM

ENTER DATE (DD-MMM-YY): <b>&lt;CR&gt;</b>

RESTART ADDR: 152010
THIS IS XXDP+.  TYPE "H" OR "H/L" FOR HELP.

.<b>D</b>

ENTRY# FILNAM.EXT        DATE          LENGTH  START

    1  HDDKB0.SYS       2-JAN-70          2    000112
    2  HMDKB1.SYS       2-JAN-70         17    000113
    3  HDDKB1.SYS       2-JAN-70          2    000114
    4  HSAAC4.SYS       8-DEC-82         24    000115
....
</pre>


<h3>Example boot of BSD 2.9</h3>
<pre>
BOOT&gt; <b>boot rl0</b>
:boot

45Boot
: <b>rl(0,0)rlunix</b>

CONFIGURE SYSTEM:
xp 0 csr 176700 vector 254 attached
rk 0 csr 177400 vector 220 attached
hk ? csr 177440 vector 210 skipped:  No CSR
rl 0 csr 174400 vector 160 attached
rp ? csr 176700 vector 254 interrupt vector already in use
ht 0 csr 172440 vector 224 skipped:  No CSR
tm 0 csr 172520 vector 224 skipped:  No CSR
...
Erase=^?, kill=^U, intr=^C
# <b>ls -al</b>
total 546
drwxr-xr-x11 root     daemon       512 Mar  7 09:00 .
drwxr-xr-x11 root     daemon       512 Mar  7 09:00 ..
-rw-rw-r-- 1 root     daemon       164 Sep 29 09:20 .cshrc
-rw-rw-r-- 1 root     daemon       266 Mar  7 08:43 .login
-rw-rw-r-- 1 root     superuse       2 Jul 26 16:00 .msgsrc
-rw-rw-r-- 1 root     daemon       116 Mar 30 00:59 .profile
-rw-r--r-- 1 root     superuse      56 Nov 20 16:03 2.9stamp
-rw-rw-r-- 1 root     superuse     450 Mar 30 00:50 READ_ME
drwxrwxr-x 2 bin      bin         1632 Nov 20 16:04 bin
-rwxrwxr-x 1 root     superuse   23572 Mar  7 09:05 boot
...
# <b>cat /etc/passwd</b>
root::0:2:The Man:/:/bin/csh
toor::0:2:The Man:/:
daemon:***:1:1:The devil himself:/:
sys:***:2:1::/:
bin:***:3:1::/:
uucp::4:1:UNIX-to-UNIX Copy:/usr/spool/uucppublic:/usr/lib/uucp/uucico
notes:***:5:1:Notesfiles maintainer:/usr/spool/notes:
anon:***:6:1:Notesfiles anonymous user:/usr/spool/notes:
news:***:7:1:News maintainer:/usr/spool/news:
wnj:ZDjXDBwXle2gc:8:2:Bill Joy,457E,7780:/a/guest/wnj:/bin/csh
dmr:AiInt5qKdjmHs:9:2:Dennis Ritchie:/a/guest/dmr:
ken:sq5UDrPlKj1nA:10:2:&amp; Thompson:/a/guest/ken:
mike:KnKNwMkyCt8ZI:11:2:mike karels:/a/guest/mike:/bin/csh
carl:S2KiTfS3pH3kg:12:2:&amp; Smith,508-21E,6258:/a/guest/carl:/bin/csh
joshua::999:2:&amp;:/usr/games:/usr/games/wargames
# <b>CTRL/D</b>
Wed Dec 31 16:04:16 PST 1969
/etc/fstab: No such file or directory
/usr/sys: No such file or directory
init: /dev/tty07: cannot open
...

Berkeley Unix 2.9BSD

:login: <b>root</b>

Welcome to the 2.9BSD (Berkeley) UNIX system.

tty: Command not found.
# <b>ls -al /bin</b>
total 1182
-rwxrwxr-x 1 bin      bin         8692 Dec 31 16:59 #
drwxrwxr-x 2 bin      bin         1632 Nov 20 16:04 .
drwxr-xr-x11 root     daemon       512 Mar  7 09:00 ..
-rwxrwxr-x 2 bin      bin         2917 Dec 31 16:59 [
-rwxrwxr-x 1 bin      bin        30340 Mar 24 08:27 adb
-rwxrwxr-x 1 bin      bin         9844 Dec 31 16:58 ar
-rwxrwxr-t 1 bin      bin         5626 Sep 30 17:39 as
-rwxrwxr-x 1 bin      bin         4508 Jan 18 08:22 cat
-rwxrwxr-t 1 bin      bin         7314 Oct  9 04:04 cc
-rwxrwxr-x 1 bin      bin         5096 Dec 31 16:59 chgrp
-rwxrwxr-x 1 bin      bin         3364 Dec 31 16:59 chmod
...
</pre>


<h3>Example boot of RSTS/E v7.0</h3>
<pre>
BOOT&gt; <b>boot rl2</b>

RSTS V7.0-07 Vixen (DL2)

Option: <b>&lt;LF&gt;</b>

You currently have: JOB MAX = 63, SWAP MAX = 31K.

Default memory allocation table specifies nonexistent memory.
Table will be reset by RSTS.

  Memory allocation table:

     0K: 00000000 - 00203777 (  33K) : EXEC
    33K: 00204000 - 00303777 (  16K) : RTS (BASIC)
    49K: 00304000 - 00757777 (  75K) : USER
   124K: 00760000 - End              : NXM

  Table suboption? <b>&lt;LF&gt;</b>

You currently have crash dump enabled.
CRASH.SYS file of 50 blocks is not available
Crash dump automatically disabled

DD-MMM-YY? <b>31-OCT-81</b>
12:00 PM? <b>12:00</b>
INIT    V7.0-07A        RSTS V7.0-07 Vixen

Command File Name? <b>&lt;CR&gt;</b>
DETACHING...
...
<b>HELLO 1,2</b>
Password: <b>system</b>
Job 1 is detached under this account
Job number to attach to? <b>&lt;CR&gt;</b>
1 other user is logged in under this account

WELCOME TO RSTS/E V7.0 TIME SHARING

Ready

<b>PRINT "Hello world",PI*4</b>
Hello world     12.5664

Ready

<b>DIR</b>
 Name .Ext    Size   Prot    Date       SY:[1,2]
CREATE.LOG       3   &lt; 60&gt; 31-Oct-81
LOGIN .SAV      13   &lt;232&gt; 23-Sep-79
LOGOUT.SAV      11   &lt;232&gt; 23-Sep-79
PIP   .SAV      50   &lt;232&gt; 23-Sep-79
...

Ready

<b>SYSTAT</b>

RSTS V7.0-07 Vixen status at 31-Oct-81, 12:01 PM Up: 1:53

Job    Who    Where    What    Size    State    Run-Time  Pri/RB   RTS
 1    [SELF]  Det     ERRCPY   5/31K   SR            7.5    0/6   BASIC
 2    [SELF]  KB0     SYSTAT  11/31K   RN Lck        9.0   -8/6   BASIC

Busy Devices: None

Disk Structure:
Disk    Open    Free    Cluster Errors  Name    Comments
DL2       2     5568       2      0     VIXEN   Pub, DLW

Small   Large   Jobs    Hung TTY's      Errors
478       0      2/8        0              0

Run-Time Systems:
 Name   Ext       Size  Users   Comments
BASIC   BAC     16(16)K   2     Perm, Addr:33, KBM, CSZ
RT11    SAV      4(28)K   0     Temp, Addr:65, KBM, CSZ, EMT:255
TECO    TEC      8(24)K   0     Non-Res

Resident Libraries: None

Message Receivers:
 Name   Job     Msgs    Max     Senders
ERRLOG   1       0      40      Priv

Ready
</pre>

<h3>Example boot of XXDP</h3>
<pre>
BOOT&gt; <b>boot rl3</b>

CHMDLD0 XXDP+ DL MONITOR
BOOTED VIA UNIT 3
28K UNIBUS SYSTEM

ENTER DATE (DD-MMM-YY): <b>&lt;CR&gt;</b>

RESTART ADDR: 152010
THIS IS XXDP+.  TYPE "H" OR "H/L" FOR HELP.

.<b>D</b>

ENTRY# FILNAM.EXT        DATE          LENGTH  START

    1  MMDP  .SAV       3-MAR-83C        17    000310
    2  MTDP  .SAV       3-MAR-83C        17    000331
    3  HSAAD0.SYS       3-MAR-83         24    000352
    4  HSABC0.SYS       3-MAR-83         28    000402
    5  HSACC0.SYS       3-MAR-83         27    000436
    6  HSADB0.SYS       3-MAR-83         25    000471
    7  HUDIB0.SYS       3-MAR-83          5    000522
    8  HELP  .TXT       3-MAR-83         14    000527
...
</pre>


<h3>Example boot of ULTRIX-11 System V3.1</h3>
<pre>
BOOT&gt; <b>boot rp0</b>

Sizing Memory...

Boot: hp(0,0)unix    (CTRL/C will abort auto-boot)

Load device (? for help, &lt;RETURN&gt; if none) &lt; ht tm ts tk rx rl rc &gt; ? <b>&lt;CR&gt;</b>

hp(0,0)unix: 14784+17024+8192+8000+8064+8000+8064+8128+8000+7808+7936+7936+7680+7360+1344

ULTRIX-11 Kernel V3.1

realmem = 253952
buffers = 25600
clists  = 1600
usermem = 94784
maxumem = 94784
erase = delete, kill = ^U, intr = ^C
#
</pre>

<h3>Example boot of RSX 11M 4.6</h3>
<pre>
BOOT&gt; <b>boot rp2</b>

  RSX-11M V4.6 BL56   124.K MAPPED
&gt;RED DB1:=SY:
&gt;RED DB1:=LB:
&gt;MOU DB1:RSXM56
&gt;@DB1:[1,2]STARTUP
&gt;* PLEASE ENTER TIME AND DATE (HR:MN DD-MMM-YY) [S]: <b>&lt;CR&gt;</b>
&gt;TIM
00:00:11 29-APR-74
&gt;* ENTER LINE WIDTH OF THIS TERMINAL [D D:132.]: <b>&lt;CR&gt;</b>
&gt;SET /BUF=TI:132.
&gt;ACS SY:/BLKS=1024.
&gt;;
&gt;; This system startup command file (LB:[1,2]STARTUP.CMD) contains a
&gt;; template of commands to initialize the queue print spooler and queue
....
&gt;INS LB:[1,54]INI.TSK
&gt;INS LB:[1,54]MAC.TSK
&gt;@ &lt;EOF&gt;
&gt;<b>BYE</b>
Have a nice day
29-APR-74 00:00 TT0:  logged off VIXEN
</pre>

<h3>Example boot of RSTS V9.6</h3>
<pre>
BOOT&gt; <b>boot rp3</b>

RSTS V9.6-11 VIXEN  (DB3) INIT V9.6-11

Today's date? <b>31-OCT-86</b>

Current time? <b>10:02</b>

Start timesharing? &lt;Yes&gt; <b>&lt;CR&gt;</b>

Cannot use extra 12K of buffers.  Reduced to 11K.

Size of monitor has changed from 73K to 72K.

Default memory allocation table shows MORE
memory than INIT detects on this machine.

Adjusting memory table.
Not enough room for current allocation of XBUF.
  Resetting memory table.

  Memory allocation table:

     0K: 00000000 - 00363777 (  61K) : EXEC
    61K: 00364000 - 00727777 (  57K) : USER
   118K: 00730000 - 00757777 (   6K) : XBUF

Memory available to RSTS/E is 124K words.

31-Oct-86 10:02 AM

11 devices disabled

Proceed with system startup? &lt;YES&gt; <b>&lt;CR&gt;</b>

 Beginning RSTS/E system startup...
31-Oct-86 10:02 AM   Installing monitor overlays
31-Oct-86 10:02 AM   Mounting disks
31-Oct-86 10:02 AM   Assigning logical names
31-Oct-86 10:02 AM   Starting error logging
31-Oct-86 10:02 AM   Setting system characteristics
31-Oct-86 10:02 AM   Installing run-time systems and libraries
 install/library/noaddress=unrestricted EDT$:EDT
                 ^
?Memory would be fragmented
31-Oct-86 10:02 AM   Setting terminal characteristics
31-Oct-86 10:02 AM   Defining system commands
31-Oct-86 10:02 AM   Setting printer characteristics
31-Oct-86 10:02 AM   Starting spoolers

*** From [1,2] on KB0: at 10:02 AM 31-Oct-86
** RSTS/E is on the air...


</pre>


<h3>Bugs?</h3>
<p>
Plenty! Especially in the places where I haven't managed to figure out what a real PDP 11/45 should do. :-( Core PDP 11/45
stuff is well documented but some lesser used system functions require reverse engineering to understand.
<p>
If you have something you want me to look at let me know and I'll prioritise. However always happy to accept fixes!

<p><a href='http://skn.noip.me/pdp11/pdp11-45.html'>home</a>

<script src='bootcode.js' type="text/javascript"></script>
<script src='pdp11.js' type="text/javascript"></script>
<script src='iopage.js' type="text/javascript"></script>
<script src='fpp.js' type="text/javascript"></script>
<script src='vt11.js' type="text/javascript"></script>

<script type="text/javascript">
var panel = {
    address: 0x3fffff,	// address lights
    display: 0xffff,	// data lights
    status: 0xfff,		// status lights - top row - addr err, run, mode, MMU status
    select: 0x3011,		// select switches + parity lights
    rotary1: 0,
    rotary2: 0,
    halt: 0,
    step: 0,
    lamp: 0,
    autoIncr: 0
};

function regExamineDeposit(data) {
    var result, autoMask;
    if (data < 0) {
        autoMask = 1; // Examine auto increment mask
    } else {
        autoMask = 2; // Deposit auto increment mask
    }
    if (panel.autoIncr & autoMask) {
        CPU.displayAddress = (CPU.displayAddress & 0777700) | ((CPU.displayAddress + 1) & 017);
        panel.address = updatePanel("a", panel.address, CPU.displayAddress);
    }
    if (data < 0) {
        result = readWordByAddr((CPU.displayAddress & 017) | 017777700); // register examine -> read
    } else {
        result = writeWordByAddr((CPU.displayAddress & 017) | 017777700, data & 0xffff); // register deposit -> write
    }
    if (result >= 0) {
        panel.display = updatePanel("d", panel.display, result);
        panel.select = updatePanel('s', panel.select, panel.select & ~0x4000); // Address err light
        panel.autoIncr = autoMask; // Set auto increment for next time
    } else {
        panel.select = updatePanel('s', panel.select, panel.select | 0x4000); // Address err light
        panel.autoIncr = 0;
    }
    if (CPU.cpuType !== 70) CPU.displayAddress &= 0x3ffff;
}

function examineDeposit(data) {
    var result, autoMask, trapState;
    if (data < 0) {
        autoMask = 1; // Examine auto increment mask
    } else {
        autoMask = 2; // Deposit auto increment mask
    }
    if (panel.rotary2 > 1) { // If a virtual address is selected...
        CPU.displayAddress &= 0xffff;
    } else {
        if (CPU.cpuType !== 70 && CPU.displayAddress >= IOBASE_18BIT) CPU.displayAddress |= IOBASE_22BIT;
    }
    if (panel.autoIncr & autoMask) {
        if (CPU.displayAddress >= 017777700 && CPU.displayAddress <= 017777717) {
            CPU.displayAddress++; // register addresses increment by 1
            if (CPU.displayAddress >= 017777720) CPU.displayAddress = 017777700; // register loop
        } else {
            CPU.displayAddress += 2;
        }
        panel.address = updatePanel("a", panel.address, CPU.displayAddress);
    }
    trapState = CPU.trapPSW;
    CPU.trapPSW = -2; // Disable trap handling
    if (panel.rotary2 > 1) { // If a virtual address is selected...
        CPU.mmuMode = panel.rotary2 >> 1;
        if (CPU.mmuMode < 3) CPU.mmuMode--;
        if (data < 0) {
            result = readWordByVirtual((CPU.displayAddress & 0xffff) | (((panel.rotary2 + 1) & 1) << 16));
        } else {
            result = mapVirtualToPhysical((CPU.displayAddress & 0xffff) | (((panel.rotary2 + 1) & 1) << 16));
            if (result >= 0) {
                result = writeWordByAddr(result, data & 0xffff);
            }
        }
        if (result >= 0) {
            CPU.mmuMode = (CPU.PSW >> 12) & 3; // Put back proper mode.
        }
    } else { // Physical address then
		if (CPU.displayAddress < IOBASE_UNIBUS && ((CPU.displayAddress & 1) || CPU.displayAddress >= MAX_MEMORY)) {
			result = -1; // Odd address / out of bounds check for unvalidated memory address
		} else {
			if (data < 0) {
				result = readWordByAddr(CPU.displayAddress); // examine -> read
			} else {
				result = writeWordByAddr(CPU.displayAddress, data & 0xffff); // deposit -> write
				if (result < 0 && CPU.displayAddress == 017777776) result = readPSW(); // Knew that PSW write kludge would get me
			}
        }
    }
    CPU.trapPSW = trapState; // Reenable trap handling
    if (result >= 0) {
        panel.display = updatePanel("d", panel.display, result);
        panel.autoIncr = autoMask; // Set auto increment for next time
    } else {
        panel.autoIncr = 0;
    }
	updateStatusLights(result < 0 ? 0x400: 0); // Update status lights
    if (CPU.cpuType !== 70) CPU.displayAddress &= 0x3ffff;
}


function updatePanel(id, original, value) {
    var i = 0,
        element, mask;
    if (panel.lamp <= 0) {
        mask = original ^ value;
        while (mask) {
            if (mask & 1) {
                element = document.getElementById(id + i);
                if (element) element.style.visibility = ((value >> i) & 1 ? 'visible' : 'hidden');
            }
            mask >>= 1;
            i++;
        }
    }
    return value;
}

function moveSwitch(id, top) {
    document.getElementById(id).style.borderTopWidth = top;
    document.getElementById(id).style.borderBottomWidth = 44 - top;
}

function setSwitch(id, value) {
    CPU.switchRegister ^= value;
	if (panel.rotary1 == 2) panel.display = updatePanel("d", panel.display, CPU.switchRegister);
    if (CPU.switchRegister & value) {
        moveSwitch(id, 8);
    } else {
        moveSwitch(id, 22);
    }
}

function console_enable() {}

function cpu_halt() {
    console.log("Halted at " + CPU.registerVal[7].toString(8) + " PSW: " + readPSW().toString(8));
    for (i = 0; i < 8; i++) {
        console.log(" R" + i + "  " + CPU.registerVal[i].toString(8));
    }
}

function console_input(ascii) {
    tty.rbufQueue.push(ascii);
    if (!(tty.rcsr & 0x80)) {
        tty_rbuf();
    }
    document.forms.console.line.focus();
}

function console_read(event) {
    console_input(event.charCode || event.keyCode);
    return false;
}

function console_keyup(event) {
    var code = event.charCode || event.keyCode;
    if (code == 8 || code == 127) {
        console_input(tty.delCode);
        tty.del = 1;
    }
    return false;
}

function console_paste(event) {
    var i, cb = event.clipboardData.getData('text/plain') || window.clipboardData.getData('Text');
    if (cb && cb.length > 0) {
        for (i = 0; i < cb.length; i++) {
            if (cb.charCodeAt(i) != 015) console_input(cb.charCodeAt(i));
        }
    }
    return false;
}

function putchar(data) {
    switch (data) {
        case 0:
        case 015:
            if (document.forms.console.line.value.length > 12000) {
                document.forms.console.line.value = document.forms.console.line.value.substring(document.forms.console.line.value.length - 4000);
            }
            break;
        case 010:
            if (!tty.del) {
                document.forms.console.line.value = document.forms.console.line.value.substring(0, document.forms.console.line.value.length - 1);
            }
            break;
        default:
            document.forms.console.line.value += String.fromCharCode(data);
            if (data == 012) {
                document.forms.console.line.scrollTop = document.forms.console.line.scrollHeight;
            }
    }
    tty.del = 0;
}

function boot() {
    var i;
    for (i = 0; i < IOBASE_UNIBUS / 2; i++) {
        CPU.memory[i] = 0;
    }
    for (i = 0; i < bootcode.length; i++) {
        CPU.memory[(BOOTBASE >> 1) + i] = bootcode[i];
    }
    CPU.registerVal[7] = CPU.registerVal[6] = BOOTBASE;
    CPU.PIR = 0;
    writePSW(0);
    reset_iopage();
    if (CPU.runState != STATE.RUN) {
        CPU.runState = STATE.RUN;
        emulate();
    }
}

document.forms.console.line.onkeypress = console_read;
document.forms.console.line.onkeyup = console_keyup;
document.forms.console.line.onpaste = console_paste;
updatePanel('s', 0x3fff ^ panel.select, panel.select);
document.forms.console.line.focus();
CPU.cpuType = 45; // This is a PDP 11/45
boot();
</script>

</body>
</html>
